---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
author: Tony G. Bolaño
---


## Loading and preprocessing the data

First of all we unzip the data file, which extracts ```activity.csv``` file. If ```activity.csv``` exists it will be overwritten.

The scripts stops if no file ```activity.zip``` was found in working directory or it couldn't be unzipped.

```{r echo=FALSE, "Seeting working directory"}
setwd("T:/Formacion/Data Scientist/05 Reproducible research/Assignment 1/RepData_PeerAssessment1/")
```

```{r "Clean workspace and unzip data file"}
zipfile <- "activity.zip"
if (!file.exists(zipfile)) {
    stop ("No activity.zip zipped data file found on working directory")
}
tryCatch({
    unzip("activity.zip", overwrite = TRUE)
}, warning = function(war) {
    stop("Some warnings occur extracting file. Process has stopped.")
}, error = function(err) {
    stop("Error unzipping data file. Process has stopped.")
})
```

Once we have tha CSV file, we import its data into activity data.frame.

```{r "Load CSV data file into activity data.frame"}
activity <- read.csv("activity.csv")
```


## What is mean total number of steps taken per day?

First we calculate total steps by day using ```aggregate``` function and plot an histogram with resulting data.frame.

```{r "Steps by day"}
steps_by_day <- aggregate(steps ~ date, activity, sum)
library(ggplot2)
p <- ggplot(steps_by_day, aes(x = (steps)))
p <- p + labs( x = "Steps", y = "Count of days", title = "Histogram: Steps taken per day")
p <- p + geom_histogram(binwidth = 3000 ,aes(fill = ..count..))
p
```

And now calculate mean and median

```{r "Mean and media steps by day"}
mean(steps_by_day$steps)
median(steps_by_day$steps)
```

## What is the average daily activity pattern?

First we calculate the mean of steps on each five minutes interval. and draw a time series plot, marking the value of max. average steps at the top of the line.

```{r "Average steps by interval"}
int_avg <- aggregate(steps ~ interval, activity, mean)

p <- ggplot( int_avg, aes(x = interval, y = steps)) + geom_line(colour = "#0000CC")
p <- p + labs(x = "Interval", y = "Steps average", title = "Steps average by time interval")
p
```

With this data.frame we calculate max value for steps and which interval correspond to that value.

```{r "Interval with max. average steps"}
maxavg <- max(int_avg$steps)
maxint <- int_avg[int_avg$steps == maxavg,"interval"]
maxint
```

As you can see, the max average of steps is around **`r round(maxavg)`** steps at **`r maxint`** interval.


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
